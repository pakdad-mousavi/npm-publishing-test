## AI Test Generation Prompt

Write Vitest unit tests for the following code.

Rules:
- List logical branches and edge cases first
- Write tests that verify observable behavior only
- Use clear test names
- Cover error and boundary cases
- Do not test implementation details
- Assume ESM and Vitest

Code:
<PASTE CODE HERE>
